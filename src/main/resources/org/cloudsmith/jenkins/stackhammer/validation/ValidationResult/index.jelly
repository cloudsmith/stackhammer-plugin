<j:jelly xmlns:j="jelly:core" xmlns:st="jelly:stapler" xmlns:d="jelly:define"
	xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">

	<l:layout title="Stack Hammer">
		<l:main-panel>
			<h1>Stack Hammer Validation Report</h1>
			<j:choose>
				<j:when test="${it.validationGraphURL != null}">
					<a href="${it.validationGraphURL}" target="_blank">Dependency Graph</a>
				</j:when>
				<j:otherwise>
					No dependency graph was generated
				</j:otherwise>
			</j:choose>
			<br/>
			<h2>Errors and Warnings</h2>
			<j:choose>
				<j:when test="${it.resultDiagnosticsCount != 0}">
					<table id="validationDiagnosticsTable" border="1px" class="pane sortable">
						<thead>
							<tr>
								<td class="pane-header">Severity</td>
								<td class="pane-header">Description</td>
								<td class="pane-header">Location</td>
							</tr>
						</thead>
						<tbody>
							<j:forEach var="diag" items="${it.resultDiagnostics}">
								<j:if test="${diag.resourcePath != null}">
									<tr>
										<td>${diag.severityString}</td>
										<td>${diag.message}</td>
										<td>
											<j:choose>
												<j:when test="${diag.line != 0}">
													<a href="${it.stackBase}${diag.resourcePath}#L${diag.line}" target="_blank">${diag.resourcePath}: ${diag.line}</a>:
												</j:when>
												<j:otherwise>
													<a href="${it.stackBase}${diag.resourcePath}" target="_blank">${diag.resourcePath}</a>:
												</j:otherwise>
											</j:choose>
										</td>
									</tr>
								</j:if>
							</j:forEach>
						</tbody>
					</table>
				</j:when>
				<j:otherwise>The validation did not produce any diagnostics</j:otherwise>
			</j:choose>
		</l:main-panel>
	</l:layout>
</j:jelly>
